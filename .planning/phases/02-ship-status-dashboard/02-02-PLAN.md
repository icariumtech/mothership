---
phase: 02-ship-status-dashboard
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - src/components/domain/dashboard/sections/StatusSection.tsx
  - src/components/domain/dashboard/sections/StatusSection.css
  - src/entries/SharedConsole.tsx
autonomous: true

must_haves:
  truths:
    - "STATUS bridge tab shows ship name, class, and overall status"
    - "Hull integrity and armor bars display current/max with numeric values"
    - "4 system panels show status label, condition bar, and info line"
    - "Crew count and capacity are displayed"
    - "Status panels use color-coded labels matching 5-tier state"
    - "Critical systems pulse, offline systems dim"
    - "Tab load triggers staggered boot-up reveal animation"
  artifacts:
    - path: "src/components/domain/dashboard/sections/StatusSection.tsx"
      provides: "Complete STATUS tab with schematic, system panels, hull/armor bars"
      min_lines: 150
    - path: "src/components/domain/dashboard/sections/StatusSection.css"
      provides: "Animations (stagger reveal, pulse, flicker) and layout styles"
      min_lines: 100
  key_links:
    - from: "src/components/domain/dashboard/sections/StatusSection.tsx"
      to: "src/types/shipStatus.ts"
      via: "ShipStatusData import"
      pattern: "import.*ShipStatusData.*from.*shipStatus"
    - from: "src/components/domain/dashboard/sections/StatusSection.tsx"
      to: "window.INITIAL_DATA.shipStatus"
      via: "initial data loading"
      pattern: "INITIAL_DATA.*shipStatus"
    - from: "src/entries/SharedConsole.tsx"
      to: "src/types/shipStatus.ts"
      via: "InitialData interface extension"
      pattern: "shipStatus.*ShipStatusData"
---

<objective>
Build the StatusSection React component for the Bridge STATUS tab — ship schematic centerpiece, 4 flanking system panels, hull/armor bars, crew count, and CSS animations (staggered reveal, persistent pulse, state-change flicker).

Purpose: Delivers the player-facing ship status dashboard — the visual centerpiece of Phase 2.
Output: Fully styled StatusSection with all system panels, animations, and ship schematic.
</objective>

<execution_context>
@/home/gjohnson/.claude/get-shit-done/workflows/execute-plan.md
@/home/gjohnson/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-ship-status-dashboard/02-01-SUMMARY.md
@STYLE_GUIDE.md
@src/components/ui/README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: StatusSection component with layout, system panels, and schematic</name>
  <files>
    src/components/domain/dashboard/sections/StatusSection.tsx
    src/components/domain/dashboard/sections/StatusSection.css
    src/entries/SharedConsole.tsx
  </files>
  <action>
**Replace the placeholder StatusSection.tsx with a full implementation.**

Read the existing LogsSection.tsx and PersonnelSection.tsx for patterns (data loading from INITIAL_DATA, layout structure, CSS class naming).

Read STYLE_GUIDE.md for color palette and panel styling conventions.

**Component Structure:**

StatusSection.tsx should contain these sub-components (all in the same file to keep it manageable):

1. **StatusSection** (main export):
   - Reads ship data from `window.INITIAL_DATA.shipStatus` (same pattern as LogsSection reads sessions)
   - Polls `/api/ship-status/` every 3 seconds for GM-toggled state changes
   - Compares previous system statuses to detect changes and trigger flicker animation
   - Renders the full layout: ship identity header, schematic center, flanking panels

2. **ShipSchematic** (inline component):
   - SVG blueprint-style top-down ship view
   - Use `<svg viewBox="0 0 400 600" preserveAspectRatio="xMidYMid meet">` for vertical ship orientation
   - Background: subtle grid pattern via `<pattern>` element using border-subtle color
   - Ship outline: simple polygon/path with teal stroke (#4a6b6b), dark fill
   - Section labels: BRIDGE, CARGO, ENGINES in muted text
   - Style with CSS variables from the design system
   - No hull damage effects on schematic (per user decision)

3. **SystemStatusPanel** (inline component):
   - Props: `name`, `status`, `condition`, `info`, `isChanging` (for flicker)
   - Uses DashboardPanel wrapper with title={name}
   - Status label text, color-coded by state:
     - ONLINE: teal (#4a6b6b)
     - STRESSED: amber (#8b7355)
     - DAMAGED: orange (#9a6045)
     - CRITICAL: red (#8b5555) — persistent pulse animation
     - OFFLINE: gray (#3a3a3a) — dimmed/grayed appearance
   - Condition bar: native div with percentage width fill, colored by status
   - Info line: 1-2 lines of flavor text below the bar
   - CSS class `status-${status.toLowerCase()}` for persistent animations
   - CSS class `state-changing` applied temporarily (400ms) when status changes for flicker

4. **StatusBar** (inline component):
   - Props: `current`, `max`, `label`, `variant`
   - Percentage fill bar with numeric display (e.g., "HULL: 45/60")
   - Color varies by variant (hull uses teal, armor uses amber)

**Layout (per user decision):**
```
┌──────────────────────────────────────┐
│  SHIP NAME  │  CLASS  │ CREW: 7/12   │  <- Ship Identity Header
├─────────┬──────────────┬─────────────┤
│ LIFE    │              │   WEAPONS   │
│ SUPPORT │              │             │
│         │   [SHIP      │             │
├─────────┤  SCHEMATIC]  ├─────────────┤
│ ENGINES │              │   COMMS     │
│         │              │             │
│         │              │             │
├─────────┴──────────────┴─────────────┤
│    HULL: ████████░░  45/60           │
│    ARMOR: ████░░░░░  8/12            │
└──────────────────────────────────────┘
```

Use CSS Grid for the main layout:
- Header row spanning full width
- Middle: 3-column grid (left panels | schematic | right panels)
- Bottom: hull/armor bars spanning full width

**Polling for state changes:**
```typescript
useEffect(() => {
  const interval = setInterval(async () => {
    try {
      const res = await fetch('/api/ship-status/');
      const data = await res.json();
      setShipData(data);
    } catch (err) {
      console.error('Failed to poll ship status:', err);
    }
  }, 3000);
  return () => clearInterval(interval);
}, []);
```

Track previous system statuses via useRef. When a system's status changes between polls, set that system's `isChanging` flag to true, then clear it after 400ms (flicker duration).

**SharedConsole.tsx update:**
- Add `shipStatus?: ShipStatusData` to the InitialData interface (follow the sessions pattern)

**Staggered reveal on mount:**
- Apply CSS animation classes for boot-up sequence:
  - Ship schematic fades in first (0.6s delay)
  - System panels appear one by one (0.6s, 0.8s, 1.0s, 1.2s delay)
  - Hull/armor bars appear last (1.4s delay)
- Use `animation: fade-slide-in` with `animation-fill-mode: backwards` to prevent FOUC

**CSS file (StatusSection.css):**

Define the following:
- `.section-status` — main container, CSS grid layout
- `.ship-identity-header` — top bar with ship name, class, crew
- `.status-layout` — 3-column grid for panels + schematic
- `.ship-schematic` — SVG container styling
- `.system-panel` — base panel styling
- `.status-online`, `.status-stressed`, `.status-damaged`, `.status-critical`, `.status-offline` — color states
- `.state-changing` — flicker keyframe (0.4s, opacity oscillation)
- `.status-critical` — persistent pulse keyframe (2s, gentle opacity + border pulse)
- `.status-offline` — dimmed opacity (0.5), grayscale
- `.status-bar` — bar container with background, fill, and text overlay
- `@keyframes fade-slide-in` — stagger reveal (opacity 0→1, translateY 8px→0)
- `@keyframes flicker` — state change flicker
- `@keyframes pulse-critical` — persistent critical pulse
- Stagger delays using nth-child or explicit classes

Color variables to define in the CSS:
```css
.section-status {
  --status-online: #4a6b6b;
  --status-stressed: #8b7355;
  --status-damaged: #9a6045;
  --status-critical: #8b5555;
  --status-offline: #3a3a3a;
}
```

Use Cascadia Code font (project standard). Follow the same CSS patterns as LogsSection.css — similar class naming, positioning, color usage.
  </action>
  <verify>
Run: `npx tsc --noEmit` — no TypeScript errors.
Run: `npm run build` — successful production build.
Visually: Navigate to bridge STATUS tab — ship schematic visible, 4 system panels flanking it, hull/armor bars at bottom, boot-up stagger animation plays on tab switch.
  </verify>
  <done>StatusSection replaces placeholder. Ship identity header shows name/class/crew. SVG schematic renders as blueprint. 4 system panels show status/condition/info with color coding. Hull and armor bars show current/max. Staggered reveal animation plays on mount. Critical systems pulse. Offline systems dim. State changes trigger flicker. Polls for GM updates every 3s.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes
2. `npm run build` succeeds
3. Bridge STATUS tab shows ship schematic, 4 system panels, hull/armor bars
4. Boot-up stagger animation visible on tab load
5. System panels use correct colors per status tier
</verification>

<success_criteria>
- STATUS tab shows ship name "USCSS Morrigan", class, and crew count 7/12
- Hull bar shows 45/60 with visual fill
- Armor bar shows 8/12 with visual fill
- Life Support (ONLINE/teal), Engines (STRESSED/amber), Weapons (ONLINE/teal), Comms (DAMAGED/orange) panels visible
- Ship schematic SVG renders as blueprint-style top-down view
- Staggered reveal animation plays when switching to STATUS tab
- Polling fetches updated state every 3 seconds
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-ship-status-dashboard/02-02-SUMMARY.md`
</output>
