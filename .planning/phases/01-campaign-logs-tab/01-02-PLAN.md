---
phase: 01-campaign-logs-tab
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - src/components/domain/dashboard/TabBar.tsx
  - src/components/domain/dashboard/BridgeView.tsx
  - src/entries/SharedConsole.tsx
  - src/components/domain/dashboard/sections/NotesSection.tsx
  - src/components/domain/dashboard/sections/LogsSection.tsx
  - src/components/domain/dashboard/sections/LogsSection.css
  - package.json
autonomous: true

must_haves:
  truths:
    - "LOGS tab appears in tab bar where NOTES was (tab renamed)"
    - "Clicking LOGS tab shows two-panel layout: session list left, detail right"
    - "Session list shows newest session first with session number, title, and date"
    - "Most recent session is auto-selected when opening LOGS tab"
    - "Selected session detail shows metadata header (session #, date, title, location, notable NPCs) and rendered markdown body"
    - "Old 'notes' value in sessionStorage is migrated to 'logs'"
    - "Empty state displays when no session files exist"
  artifacts:
    - path: "src/components/domain/dashboard/sections/LogsSection.tsx"
      provides: "Campaign logs two-panel component"
      exports: ["LogsSection"]
      min_lines: 60
    - path: "src/components/domain/dashboard/sections/LogsSection.css"
      provides: "Logs section styling matching personnel pattern"
      min_lines: 50
    - path: "src/components/domain/dashboard/TabBar.tsx"
      provides: "Tab bar with LOGS instead of NOTES"
      contains: "logs"
    - path: "src/components/domain/dashboard/BridgeView.tsx"
      provides: "BridgeView rendering LogsSection for logs tab"
      contains: "LogsSection"
  key_links:
    - from: "src/components/domain/dashboard/sections/LogsSection.tsx"
      to: "window.INITIAL_DATA.sessions"
      via: "reads session data from INITIAL_DATA"
      pattern: "INITIAL_DATA.*sessions"
    - from: "src/components/domain/dashboard/BridgeView.tsx"
      to: "src/components/domain/dashboard/sections/LogsSection.tsx"
      via: "imports and renders LogsSection"
      pattern: "import.*LogsSection"
    - from: "src/components/domain/dashboard/sections/LogsSection.tsx"
      to: "react-markdown"
      via: "renders markdown body content"
      pattern: "ReactMarkdown"
---

<objective>
Build the LOGS tab frontend: rename NOTES to LOGS in tab bar, create two-panel LogsSection component with session list and markdown detail view, install react-markdown for rendering.

Purpose: Complete the user-facing Campaign Logs feature — GM and players can browse and read session log entries in the Bridge interface.
Output: Working LOGS tab with session list sidebar, metadata header, and rendered markdown body.
</objective>

<execution_context>
@/home/gjohnson/.claude/get-shit-done/workflows/execute-plan.md
@/home/gjohnson/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-campaign-logs-tab/01-CONTEXT.md
@.planning/phases/01-campaign-logs-tab/01-RESEARCH.md
@.planning/phases/01-campaign-logs-tab/01-01-SUMMARY.md

Key source files to reference:
@src/components/domain/dashboard/sections/PersonnelSection.tsx — two-panel layout pattern to mirror
@src/components/domain/dashboard/sections/PersonnelSection.css — CSS pattern to adapt
@src/components/domain/dashboard/TabBar.tsx — tab definitions to rename
@src/components/domain/dashboard/BridgeView.tsx — tab routing to update
@src/entries/SharedConsole.tsx — sessionStorage tab persistence to migrate
@src/types/session.ts — SessionLog type (created in Plan 01)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rename NOTES tab to LOGS and update all references</name>
  <files>
    src/components/domain/dashboard/TabBar.tsx
    src/components/domain/dashboard/BridgeView.tsx
    src/entries/SharedConsole.tsx
    src/components/domain/dashboard/sections/NotesSection.tsx
  </files>
  <action>
**TabBar.tsx:**
- Change the BridgeTab type: replace `'notes'` with `'logs'` in the union type
- Update the tabs array: change `{ id: 'notes', label: 'NOTES' }` to `{ id: 'logs', label: 'LOGS' }`

**BridgeView.tsx:**
- Replace import of NotesSection with LogsSection: `import { LogsSection } from './sections/LogsSection';`
- Change the conditional render: `{activeTab === 'logs' && <LogsSection />}` (was 'notes' and NotesSection)

**SharedConsole.tsx:**
- In the tab validation list, replace `'notes'` with `'logs'`
- Add sessionStorage migration logic: after reading saved tab from sessionStorage, check if value is `'notes'` — if so, update it to `'logs'` and use `'logs'`

**NotesSection.tsx:**
- Delete this file (it only contains a placeholder "UNDER CONSTRUCTION" message). The LogsSection will replace it entirely.

These changes must be consistent — every occurrence of the string literal 'notes' that refers to the BridgeTab enum value must become 'logs'. Search the codebase to ensure nothing is missed.
  </action>
  <verify>
Run: `npx tsc --noEmit` — no TypeScript errors (ensures all tab type references are consistent).
Run: `grep -r "'notes'" src/ --include="*.tsx" --include="*.ts"` — should return no results in tab-related files (only in unrelated contexts if any).
  </verify>
  <done>BridgeTab type uses 'logs' instead of 'notes'. Tab bar shows LOGS. BridgeView renders LogsSection. SessionStorage migration handles old 'notes' value.</done>
</task>

<task type="auto">
  <name>Task 2: Install react-markdown and build LogsSection component with CSS</name>
  <files>
    package.json
    src/components/domain/dashboard/sections/LogsSection.tsx
    src/components/domain/dashboard/sections/LogsSection.css
  </files>
  <action>
**Install dependencies:**
Run `npm install react-markdown remark-gfm` to add markdown rendering support.

**LogsSection.tsx** — Create the two-panel logs component. Follow the PersonnelSection pattern closely:

Structure:
```
LogsSection (main component)
  ├── DashboardPanel title="CAMPAIGN LOGS"
  │   └── logs-split (flex container)
  │       ├── logs-list (left sidebar, 280px)
  │       │   └── Session rows (clickable, show session #, title, date)
  │       └── logs-detail (right panel, flex: 1)
  │           └── LogsDetailView (selected session)
  │               ├── Metadata header (labeled fields)
  │               └── Markdown body (ReactMarkdown)
LogsDetailView (memoized child component)
```

Implementation details:

1. **Data loading:** Read sessions from `window.INITIAL_DATA?.sessions || []` using `useMemo`. Import `SessionLog` type from `@/types/session.ts`.

2. **State:** `useState<string | null>` for selectedId (filename as identifier). Auto-select first session (newest) on mount using `useEffect`.

3. **Left sidebar (session list):**
   - Each row shows: `SESSION {number}: {title}` on first line, `{date}` on second line
   - Checkbox indicator on left (filled when selected, matching personnel pattern)
   - Newest session first (data already sorted by backend)
   - Empty state: `"> No session logs found"` centered in muted text

4. **Right detail panel (LogsDetailView):**
   - Wrap in `React.memo()` to prevent re-renders on unrelated state changes (per research pitfall #1)
   - **Metadata header block** with labeled fields:
     - SESSION: {session_number}
     - DATE: {date}
     - TITLE: {title}
     - LOCATION: {location}
     - NOTABLE NPCS: {npcs.join(', ')} — only show if npcs array is non-empty
   - Use `info-label` and `info-value` CSS classes for field labels/values (matches existing pattern)
   - **Separator line** between header and body (1px border-top)
   - **Markdown body** rendered with `<ReactMarkdown remarkPlugins={[remarkGfm]} components={markdownComponents}>` where markdownComponents provides custom styled elements:
     - h1, h2, h3: teal color, uppercase, letter-spacing
     - p: primary text color, 12px, line-height 1.8
     - strong: amber color
     - ul/ol/li: appropriate spacing and color
     - em: italic with slightly muted color
   - Empty detail state: `"> SELECT SESSION TO VIEW LOG"` centered

5. **Imports:** DashboardPanel from `@components/ui/DashboardPanel`, ReactMarkdown from 'react-markdown', remarkGfm from 'remark-gfm', SessionLog from `@/types/session`, Section.css and LogsSection.css.

**LogsSection.css** — Adapt the PersonnelSection.css pattern:

Core classes to create:
- `.section-logs` — absolute positioning matching `.section-personnel` exactly (top: 30px, bottom: 128px, left: 50%, transform, width: 75vw, max-width: 1024px, z-index: 50)
- `.section-logs .panel-wrapper` — height: 100%, max-height: 100%
- `.section-logs .panel-header h3` — hidden title text (font-size: 0) matching personnel pattern
- `.logs-split` — flex layout with 1px gap, border-subtle background
- `.logs-list` — 280px width, overflow-y auto, 8px padding, dark panel bg
- `.logs-detail` — flex: 1, overflow-y auto, 16px padding, dark panel bg
- `.logs-row` — flex row with padding, margin-bottom, dark bg, subtle border, pointer cursor, hover/selected states (copy personnel-row exactly but with logs- prefix)
- `.logs-row-checkbox` / `.logs-row-checkbox.checked` — 14px square, teal border, filled when checked
- `.logs-row-info`, `.logs-row-title`, `.logs-row-date` — match personnel-row-info/name/role pattern
- `.logs-detail-empty` — centered muted text (match personnel-detail-empty)
- `.logs-detail-body` / `.logs-detail-body.visible` — opacity transition
- `.logs-detail-header` — metadata header area with proper label/value styling
- `.logs-detail-content` — margin-top 16px, border-top separator, padding-top 16px
- Markdown element classes: `.logs-h1`, `.logs-h2`, `.logs-h3` (teal, uppercase), `.logs-p` (primary, 12px, 1.8 line-height), `.logs-strong` (amber), `.logs-em`, `.logs-ul`, `.logs-ol`, `.logs-li`
- Label/value styling: reuse `.info-label` (teal, bold) and `.info-value` (amber) from existing pattern
  </action>
  <verify>
1. Run: `npm run typecheck` — no TypeScript errors
2. Run: `npm run build` — builds successfully
3. Visual check: Start dev server, navigate to Bridge view, click LOGS tab — should show 3 sessions in left panel, detail view on right with rendered markdown
  </verify>
  <done>LogsSection component displays two-panel layout with session list (newest first, auto-selected) and detail view showing metadata header and rendered markdown body. react-markdown and remark-gfm installed. CSS matches data terminal aesthetic.</done>
</task>

</tasks>

<verification>
1. `npm run typecheck` — passes with no errors
2. `npm run build` — successful production build
3. Tab bar shows LOGS (not NOTES)
4. LOGS tab displays session list on left, detail on right
5. Most recent session (session 3) is auto-selected on tab open
6. Session detail shows all metadata fields and rendered markdown with proper styling
7. Clicking different sessions updates the detail view
8. Empty state message appears when no sessions selected
9. Old 'notes' sessionStorage value migrates to 'logs' on load
</verification>

<success_criteria>
- LOGS tab replaces NOTES in bridge view tab bar
- Two-panel layout: scrollable session list (280px left), detail view (flex right)
- Session rows show session number + title + date, newest first
- Most recent session auto-selected on LOGS tab open
- Detail view shows labeled metadata header (session #, date, title, location, notable NPCs)
- Markdown body rendered safely with terminal-aesthetic styling
- react-markdown and remark-gfm dependencies installed
- No TypeScript errors, successful build
</success_criteria>

<output>
After completion, create `.planning/phases/01-campaign-logs-tab/01-02-SUMMARY.md`
</output>
